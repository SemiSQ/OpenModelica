all : release qtclients mosh

autoconfGeneratedFiles = @GENERATED_AUTOCONF_FILES@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
includedir = @includedir@
datadir = @datadir@
docdir = @docdir@

defaultMakefileTarget = Makefile

include Makefile.common

# We don't need OMDEV hacks, but using the same Makefile sure is nice!
.testvariables:
settings:

omc: c_runtime docs
	(cd Compiler && $(MAKE) -f Makefile release)

omcd: c_runtime docs
	(cd Compiler && $(MAKE) -f Makefile debug)

qtclients: mkbuilddirs
	echo "environment variable QTHOME should be defined"
	echo "Coin3D (www.coin3d.org) and SoQt should be installed and in the path!"
	echo "using QTHOME=${QTHOME}"
	(cd OMShell && (test -f omc_communication.cc || @IDLCMD@ ../../Compiler/runtime/omc_communication.idl) && CORBALIBS="@CORBALIBS@" CORBAINCL="@CORBACFLAGS@" qmake && make && cp -p OMShell ../$(builddir_bin)/.)
	(cd OMNotebook/ext && qmake && make && cp -p ext ../../$(builddir_bin)/.)
	(cd OMNotebook/OMNotebookQT4 && (test -f omc_communication.cc || @IDLCMD@ ../../Compiler/runtime/omc_communication.idl) && USE_CORBA="@QT_USE_CORBA@" CORBALIBS="@CORBALIBS@" CORBAINCL="@CORBACFLAGS@" qmake && make)
	cp -p OMNotebook/OMNotebookQT4/OMNotebook $(builddir_bin)
	cp -p OMNotebook/OMNotebookQT4/*.xml $(builddir_share)/omnotebook
	cp -p OMNotebook/OMNotebookQT4/commands.xml $(builddir_share)/omshell

qtclean:
	rm -f OMNotebook/ext/ext
	rm -f OMShell/OMShell OMShell/omc_communication.*
	rm -f OMNotebook/OMNotebookQT4/OMNotebook OMNotebook/OMNotebookQT4/omc_communication.*
	(cd OMShell && qmake && make clean)
	(cd OMNotebook/ext && qmake && make clean)
	(cd OMNotebook/OMNotebookQT4 && qmake && make clean)

.PRECIOUS: Makefile

Makefile: Makefile.in
	$(top_builddir)/config.status
