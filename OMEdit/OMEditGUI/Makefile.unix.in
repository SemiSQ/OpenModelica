.PHONY: install build OMEdit always

NAME=OMEdit
EXE=@EXE@
QMAKE=@QMAKE@

install: build
	cp -p OMEdit ../../build/bin/OMEdit
	mkdir -p ../../build/share/doc/omedit/
	cp -p ../docs/*.pdf ../../build/share/doc/omedit/
always:

$(NAME)$(EXE): Makefile OMEdit.config
	$(MAKE) -f Makefile
ifeq ($(EXE),.app)
$(NAME): $(NAME)$(EXE) always
	cp -p ../bin/$</Contents/MacOS/$(NAME) $@
endif

build: $(NAME)
	ln -sf ../OMNotebook/3Dpkg ../
	ln -sf ../OMNotebook/Pltpkg2 ../
	$(MAKE) -f Makefile
Makefile: OMEditGUI.pro OMEdit.config
	$(QMAKE)
Makefile.unix: Makefile.unix.in
	(cd ../../; ./config.status)
OMEdit.config: OMEdit.config.in
	(cd ../../; ./config.status)
