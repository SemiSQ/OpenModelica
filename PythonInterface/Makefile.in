IDLPYTHON = omniidl -bpython
LAYOUT = `test -d /etc/apt && echo --install-layout=deb`

install: setup.py OMPython/OMConfig.py OMPython/__init__.py OMPython/OMParser/__init__.py OMPython/omc_communication_idl.py
	mkdir -p $(top_builddir)/build/lib/python2.6/dist-packages
	rm -f $(top_builddir)/build/lib/python2.6/dist-packages/OMPython
	ln -s ../../python2.7/dist-packages/OMPython $(top_builddir)/build/lib/python2.6/dist-packages/
	python setup.py install --no-compile $(LAYOUT) --prefix=$(top_builddir)/build

.PHONY: install

OMPython/omc_communication_idl.py : $(IDLFILE)
	$(IDLPYTHON) -COMPython $(IDLFILE)

Makefile: Makefile.in
	(cd $(top_builddir); ./config.status)
include Makefile.common
