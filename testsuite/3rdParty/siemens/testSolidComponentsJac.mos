// name:     simulate SolidComponents
// keywords: SiemensPower SolidComponents
// status:   correct
// cflags:   +postOptModules=inlineArrayEqn,constantLinearSystem,removeSimpleEquations,generateSymbolicJacobian,removeUnusedFunctions
// teardown_command: rm -rf SiemensPower.Components.SolidComponents.Tests.wall_test* _SiemensPower.Components.SolidComponents.Tests.wall_test* output.log
//
//  Test SiemensPower component SolidComponents
//

loadModel(Modelica);
loadFile("./SiemensPower/package.mo");

// test jacobians
simulate(SiemensPower.Components.SolidComponents.Tests.wall_test, stopTime=25, method="dassljac", simflags="-iim none -iif $OPENMODELICAHOME/../testsuite/3rdParty/siemens/ResultFiles/wall_test.mat");

res := OpenModelica.Scripting.compareSimulationResults("SiemensPower.Components.SolidComponents.Tests.wall_test_res.mat","ResultFiles/wall_test.mat","SiemensPower.Components.SolidComponents.Tests.wall_test_diff.csv",0.01,0.00001,
  { "heatInput.C1signal.y",
    "wall.layer[1].T[1]",
    "wall.layer[1].T[2]",    
    "wall.layer[1].T[3]",
    "wall.layer[1].T[4]",
    "wall.layer[1].T[5]",
    "wall.layer[2].T[1]",
    "wall.layer[2].T[2]",
    "wall.layer[2].T[3]",
    "wall.layer[2].T[4]",
    "wall.layer[2].T[5]",
    "wall.layer[3].T[1]",
    "wall.layer[3].T[2]",
    "wall.layer[3].T[3]",
    "wall.layer[3].T[4]",
    "wall.layer[3].T[5]"
});


// Result:
// true
// true
// record SimulationResult
//     resultFile = "SiemensPower.Components.SolidComponents.Tests.wall_test_res.mat",
//     simulationOptions = "startTime = 0.0, stopTime = 25.0, numberOfIntervals = 500, tolerance = 0.000001, method = 'dassljac', fileNamePrefix = 'SiemensPower.Components.SolidComponents.Tests.wall_test', storeInTemp = false, noClean = false, options = '', outputFormat = 'mat', variableFilter = '.*', measureTime = false, cflags = '', simflags = '-iim none -iif $OPENMODELICAHOME/../testsuite/3rdParty/siemens/ResultFiles/wall_test.mat'",
//     messages = ""
// end SimulationResult;
// "Files Equal!"
// endResults

